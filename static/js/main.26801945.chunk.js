(this["webpackJsonptableau-extension-exportall"]=this["webpackJsonptableau-extension-exportall"]||[]).push([[0],{208:function(e,t){},215:function(e){e.exports=JSON.parse('{"name":"tableau-extension-exportall","version":"2.2.1","private":true,"homepage":"https://adhsharad.github.io","dependencies":{"@material-ui/core":"^4.11.0","@material-ui/icons":"^4.9.1","@tableau/tableau-ui":"^3.0.0","compare-versions":"^3.6.0","file-saver":"^2.0.2","react":"^16.13.1","react-app-polyfill":"^1.0.6","react-dom":"^16.13.1","react-router-dom":"^5.2.0","react-scripts":"3.4.1","xlsx":"^0.16.5"},"scripts":{"start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all","IE 10"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"devDependencies":{"typescript":"^3.9.7"}}')},216:function(e,t,n){e.exports=n.p+"static/media/logo.78313ace.svg"},229:function(e,t,n){e.exports=n(446)},429:function(e,t,n){},435:function(e,t){},436:function(e,t){},442:function(e,t,n){},443:function(e,t,n){},444:function(e,t,n){},446:function(e,t,n){"use strict";n.r(t);n(230),n(239);var a=n(0),o=n.n(a),l=n(45),s=n.n(l),i=(n(429),n(41)),r=n(210),c=n(211),u=n(220),d=n(218),g=n(217),m=n(18),h=n(20);var f=function(e){return o.a.createElement("div",null,o.a.createElement(h.Button,{kind:e.style,disabled:e.disabled,onClick:e.export},e.label))},p=n(88),b=n.n(p),v=n(212);var x=function(){return new Promise((function(e,t){console.log("[func.js] Saving settings"),tableau.extensions.settings.set("metaVersion",2),console.log("[func.js] Authoring mode",tableau.extensions.environment.mode),"authoring"===tableau.extensions.environment.mode?tableau.extensions.settings.saveAsync().then((function(t){e(t)})).catch(t):e()}))},E=function(e,t){return new Promise((function(n,a){console.log("[func.js] Set settings",e,t);var o="";switch(e){case"sheets":o="selectedSheets";break;case"label":o="buttonLabel";break;case"style":o="buttonStyle";break;case"filename":o="filename";break;case"version":o="metaVersion";break;default:o="unknown"}tableau.extensions.settings.set(o,JSON.stringify(t)),n()}))},S=function(e,t,n){return new Promise((function(a,o){e.getSummaryDataAsync({ignoreSelection:!0}).then((function(e){console.log("[func.js] getSheetColumns existingCols",JSON.stringify(t));var o=e.columns,l=[],s=[];if(n){for(var r=0;r<o.length;r++){var c={};c.index=o[r].index,c.name=o[r].fieldName,c.dataType=o[r].dataType,c.changeName=null,c.selected=!1,l.push(c)}for(var u=0;u<t.length;u++)t[u]&&t[u].hasOwnProperty("name")&&s.push(t[u].name);console.log("[func.js] getSheetColumns existingIdx",s);var d=s.length;l=l.map((function(e,n){var a=s.indexOf(e.name),o=Object(i.a)({},e);return a>-1?(o.selected=t[a].selected,o.changeName=t[a].changeName,o.order=a):(o.order=d,d+=1),o}))}else for(var g=0;g<o.length;g++){var m={};m.index=o[g].index,m.name=o[g].fieldName,m.dataType=o[g].dataType,m.selected=!0,m.order=g+1,l.push(m)}l=l.sort((function(e,t){return e.order>t.order?1:-1})),a(l)})).catch((function(t){console.log("[func.js] Error with getSummaryDataAsync",e,t)}))}))},y=function(){return new Promise((function(e,t){console.log("[func.js] Initialise Meta");var n=[],a=tableau.extensions.dashboardContent._dashboard.worksheets.map((function(e){var t=e,a={};return a.sheetName=t.name,a.selected=!1,a.changeName=null,a.customCols=!1,n.push(S(t,null,!1)),a}));console.log("[func.js] Found ".concat(a.length," sheets"),a),Promise.all(n).then((function(t){for(var n=0;n<t.length;n++){var o=a[n];o.columns=t[n],a[n]=o,console.log("[func.js] Added ".concat(t[n].length," columns to ").concat(o.sheetName),a)}e(a)}))}))},j=function(e){return new Promise((function(t,n){console.log("[func.js] Revalidate Meta");var a=[],o=tableau.extensions.dashboardContent._dashboard.worksheets.map((function(t){var n=t,o=e.findIndex((function(e){return e.sheetName===n.name}));if(o>-1)return console.log("[func.js] Existing sheet ".concat(n.name," columns"),JSON.stringify(e[o].columns)),a.push(S(n,e[o].columns,!0)),e[o].existed=!0,e[o];var l={};return l.sheetName=n.name,l.selected=!1,l.changeName=null,l.customCols=!1,l.existed=!1,a.push(S(n,null,!1)),l}));console.log("[func.js] Found ".concat(o.length," sheets"),o),Promise.all(a).then((function(n){for(var a=0;a<n.length;a++){var l=o[a];l.columns=n[a],o[a]=l}o.forEach((function(t,n){if(t&&t.sheetName){var a=e.findIndex((function(e){return e.sheetName===t.sheetName}));o=function(e,t,n){if(n>=e.length)for(var a=n-e.length+1;a--;)e.push(void 0);return e.splice(n,0,e.splice(t,1)[0]),e}(o,n,a)}else console.log("[func.js] Sheet ordering issue. No sheet defined in idx",n)})),console.log("[func.js] Meta revalidated",JSON.stringify(o)),t(o)}))}))},C=function(e,t,n){return new Promise((function(t,a){var o="export.xlsx";n&&n.length>0&&(o=n+".xlsx"),N(e).then((function(e){var n=b.a.write(e,{bookType:"xlsx",bookSST:!1,type:"array",ignoreEC:!1});Object(v.saveAs)(new Blob([n],{type:"application/octet-stream"}),o),t()}))}))},N=function(e){return new Promise((function(t,n){console.log("[func.js] Got Meta",e);for(var a=tableau.extensions.dashboardContent.dashboard.worksheets,o=b.a.utils.book_new(),l=0,s=0,r=[],c=[],u=[],d=0;d<e.length;d++)if(e[d]&&e[d].selected){var g=e[d].changeName||e[d].sheetName;g=g.replace(/[*?/\\[\]]/gi,""),r.push(e[d].sheetName),u.push(g),c.push(e[d].columns),l+=1}r.map((function(e,n){var r=a.find((function(t){return t.name===e}));return r.getSummaryDataAsync({ignoreSelection:!0}).then((function(e){var n=e.columns,a=c[s],r=[];a.map((function(e,t){return e&&e.selected&&r.push(e.changeName||e.name),e})),n.map((function(e,t){var o=a.find((function(t){return t.name===e.fieldName}));if(o){var l=Object(i.a)(Object(i.a)({},e),{},{selected:o.selected});return l.outputName=o.changeName||o.name,n[t]=l,l}return null})),w(n,e.data).then((function(e){console.log("[func.js] Header Order",r);var n=b.a.utils.json_to_sheet(e,{header:r}),a=u[s];s+=1,b.a.utils.book_append_sheet(o,n,a),s===l&&t(o)}))})),r}))}))},w=function(e,t){return new Promise((function(n,a){for(var o=[],l=0;l<t.length;l++)o.push(O(e,t[l]));Promise.all(o).then((function(e){n(e)}))}))},O=function(e,t){return new Promise((function(n,a){for(var o={},l=0;l<e.length;l++)if(e[l].selected){var s=void 0,i=void 0;if("%null%"===t[l].value&&null===t[l].nativeValue&&"Null"===t[l].formattedValue)s="z",i=null;else switch(e[l]._dataType){case"int":case"float":s="n",i=Number(t[l].value),isNaN(i)&&(i=t[l].formattedValue);break;case"date":case"date-time":s="s",i=t[l].formattedValue;break;case"bool":s="b",i=t[l].value;break;default:s="s",i=t[l].formattedValue}var r={v:i,t:s};o[e[l].outputName]=r}n(o)}))},k=n(213),H=n.n(k);var M=function(e){function t(){var t=tableau.extensions.settings.get("selectedSheets");if(t&&null!=t){var n=JSON.parse(t);console.log("[Extension.js] refreshSettings Existing Sheet Settings Found. Refreshing",JSON.stringify(n)),j(n).then((function(t){console.log("[Extension.js] refreshSettings settings revalidated",JSON.stringify(t)),e.updateMeta(t),e.disableButton(!1)}))}var a=tableau.extensions.settings.get("buttonLabel");a&&null!=a&&(a=a.replace(/"/g,""),console.log("[Extension.js] refreshSettings Existing Label Settings Found",a),e.updateLabel(a));var o=tableau.extensions.settings.get("buttonStyle");o&&null!=o&&(console.log("[Extension.js] refreshSettings Existing Label Style Found",o),e.updateButtonStyle(o));var l=tableau.extensions.settings.get("filename");l&&null!=l&&(console.log("[Extension.js] refreshSettings Existing Filename Found",l),e.updateFilename(l))}function n(){console.log("[Extension.js] Opening configure popup");var n="".concat(window.location.origin,"/configure");tableau.extensions.ui.displayDialogAsync(n,null,{height:500,width:500}).then((function(n){t(),console.log("[Extension.js] Config window closed",e)})).catch((function(e){switch(e.errorCode){case tableau.ErrorCodes.DialogClosedByUser:console.log("[Extension.js] Dialog was closed by user"),t();break;default:console.error("[Extension.js]",e.message)}}))}return Object(a.useEffect)((function(){console.log("[Extension.js] Props Changed",e)}),[e]),Object(a.useEffect)((function(){console.log("[Extension.js] useEffect"),tableau.extensions.initializeAsync({configure:n}).then((function(){var t=tableau.extensions.settings.get("metaVersion");t?(console.log("[Extension.js] Meta Version",t),e.updateMetaVersion(t)):(console.log("[Extension.js] Meta Version",1),t=1,e.updateMetaVersion(1));var a=tableau.extensions.settings.get("selectedSheets");a&&null!=a?(console.log("[Extension.js] Existing Sheet Settings Found",JSON.parse(a)),e.updateMeta(JSON.parse(a)),e.disableButton(!1)):(console.log("[Extension.js] Can't find existing sheet settings"),y().then((function(t){return e.updateMeta(t),E("sheets",t),E("label","Export All"),x()})).then((function(e){return n()})));var o=tableau.extensions.settings.get("buttonLabel");o&&null!=o&&(o=o.replace(/"/g,""),console.log("[Extension.js] initializeAsync Existing Label Settings Found",o),e.updateLabel(o));var l=tableau.extensions.settings.get("buttonStyle");l&&null!=l&&(console.log("[Extension.js] initializeAsync Existing Label Style Found",l),e.updateButtonStyle(l));var s=tableau.extensions.settings.get("filename");s&&null!=s&&(console.log("[Extension.js] initializeAsync Existing Filename Found",s),e.updateFilename(s))}))}),[]),o.a.createElement(f,{label:e.label,style:e.style,disabled:e.disabled,export:function(){var t=tableau.extensions.settings.get("selectedSheets"),n=JSON.parse(t);"server"===tableau.extensions.environment.context?C(n,0,e.filename):(console.log("[Extension.js] Tableau Version",tableau.extensions.environment.tableauVersion),H.a.compare(tableau.extensions.environment.tableauVersion,"2019.4.0",">=")?C(n,0,e.filename):function(){var e="".concat(window.location.origin,"/desktopexport");tableau.extensions.ui.displayDialogAsync(e,"",{height:350,width:400}).then((function(e){console.log("[Extension.js] Export window closed")})).catch((function(e){switch(e.errorCode){case tableau.ErrorCodes.DialogClosedByUser:console.log("[Extension.js] Export window was closed by user");break;default:console.error("[Extension.js]",e.message)}}))}())}})},F=n(219),B=n(465),T=n(17),D=n(470),L=n(467),A=n(471),V=Object(B.a)((function(e){return{root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15)},details:{alignItems:"center"},column:{flexBasis:"50%"},label:{display:"block",fontSize:12,lineHeight:"21px",order:0},group:{color:"rgba(0, 0, 0, 0.56)",display:"inline-flex",flexDirection:"column",fontFamily:"Benton Sans, Arial, Helvetica, sans-serif",position:"relative"},strikeThrough:{textDecoration:"line-through",marginRight:5,color:"rgba(156, 156, 156, 0.8)"}}})),I=Object(T.a)({root:{boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},expanded:{}})(D.a);var J=function(e){var t,n,a=V(),l={label:"Rename",onChange:function(t){return e.changeName(t.target.value)},onClear:function(){e.changeName(null)},placeholder:e.name||"Override Export Tab Name",style:{width:200},value:e.rename||""};return o.a.createElement("div",{className:a.root},o.a.createElement(I,{square:!0,expanded:e.selected},o.a.createElement(A.a,{"aria-controls":"panel1c-content",id:"panel1c-header"},o.a.createElement("div",null,o.a.createElement(h.Checkbox,{checked:e.selected,onChange:e.select},(t=e.name,(n=e.rename)?o.a.createElement("div",null,o.a.createElement("span",{className:a.strikeThrough},t),o.a.createElement("span",null,n)):o.a.createElement("div",null,t))))),o.a.createElement(L.a,{className:a.details},o.a.createElement("div",{className:a.column},o.a.createElement(h.TextField,l)),o.a.createElement("div",{className:a.column},o.a.createElement("div",{className:a.group},o.a.createElement("label",{className:a.label},"Change Order"),o.a.createElement(h.Stepper,{min:1,max:e.sheets.length,step:1,pageSteps:1,value:e.id+1,onValueChange:function(t){return e.changeOrder(t)},className:a.stepper}))))))};var z=function(e){return e&&e.sheets?e.sheets.map((function(t,n){return o.a.createElement(J,{id:n,key:t.sheetName,name:t.sheetName,rename:t.changeName,sheets:e.sheets,selected:t.selected,select:function(){return e.selectSheet(n)},changeName:function(t){return e.changeName(n,t)},changeOrder:function(t){return e.changeOrder(n,t)}})})):o.a.createElement("div",null)},P=n(214),R=n.n(P),U=Object(B.a)((function(e){return{root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15)},details:{alignItems:"center"},column:{flexBasis:"50%"},label:{display:"block",fontSize:12,lineHeight:"21px",order:0},group:{color:"rgba(0, 0, 0, 0.56)",display:"inline-flex",flexDirection:"column",fontFamily:"Benton Sans, Arial, Helvetica, sans-serif",position:"relative"},strikeThrough:{textDecoration:"line-through",color:"rgba(156, 156, 156, 0.8)",marginRight:5}}})),_=Object(T.a)({root:{boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},expanded:{}})(D.a);var W=function(e){var t,n,a=U(),l={label:"Rename",onChange:function(t){return e.changeName(t.target.value)},onClear:function(){e.changeName(null)},placeholder:e.name||"Override Export Column Name",style:{width:200},value:e.rename||""};return o.a.createElement("div",{className:a.root},o.a.createElement(_,{square:!0},o.a.createElement(A.a,{expandIcon:o.a.createElement(R.a,null),"aria-controls":"panel1c-content",id:"panel1c-header"},o.a.createElement("div",null,o.a.createElement(h.Checkbox,{checked:e.selected,onChange:e.select},(t=e.name,(n=e.rename)?o.a.createElement("div",null,o.a.createElement("span",{className:a.strikeThrough},t),o.a.createElement("span",null,n)):o.a.createElement("div",null,t))))),o.a.createElement(L.a,{className:a.details},o.a.createElement("div",{className:a.column},o.a.createElement(h.TextField,l)),o.a.createElement("div",{className:a.column},o.a.createElement("div",{className:a.group},o.a.createElement("label",{className:a.label},"Change Order"),o.a.createElement(h.Stepper,{min:1,max:e.cols.length,step:1,pageSteps:1,value:e.id+1,onValueChange:function(t){return e.changeOrder(t)},className:a.stepper}))))))};var q=function(e){return e&&e.cols?e.cols.map((function(t,n){return o.a.createElement(W,{id:n,key:t.index,name:t.name,rename:t.changeName,selected:t.selected,select:function(){return e.colSelect(e.id,n)},changeName:function(t){return e.changeName(e.id,n,t)},cols:e.cols,changeOrder:function(t){return e.changeOrder(e.id,n,t)}})})):o.a.createElement("div",null)};var $=function(e){return e&&e.sheets?e.sheets.map((function(t,n){return t.selected?o.a.createElement("div",{key:t.sheetName},o.a.createElement("div",null,o.a.createElement("b",null,t.sheetName)),o.a.createElement(q,{id:n,name:t.sheetName,cols:t.columns,colSelect:e.colSelect,changeName:e.changeName,changeOrder:e.changeOrder})):o.a.createElement("div",{key:t.sheetName})})):o.a.createElement("div",null)},G=n(215),K={bottom:10,right:10,position:"fixed"},Q={left:10,bottom:10,position:"fixed",color:"#4f4f4f",fontSize:12};var X=function(e){return o.a.createElement("div",null,o.a.createElement("div",{style:Q},"v",G.version),o.a.createElement("div",{style:K},o.a.createElement(h.Button,{kind:"outline",style:{marginRight:12},onClick:e.resetSettings},"Reset"),o.a.createElement(h.Button,{kind:"primary",style:{marginRight:12},disabled:!e.enableButton,onClick:e.save},"Save Changes")))},Y=n(468),Z=Object(B.a)((function(e){return{root:{flexGrow:1},gridItem:{marginTop:10}}}));var ee=function(e){var t=Z(),n={label:"Button Label",onChange:function(t){console.log("[ConfigureTab.js] Updating Button Label",t.target.value),e.updateLabel(t.target.value)},onClear:function(){e.updateLabel("Export All")},placeholder:"Button Label",style:{width:400},value:e.label||""},a={label:"Export Filename",onChange:function(t){return e.updateFilename(JSON.stringify(t.target.value))},onClear:function(){e.updateFilename("ExportAll")},placeholder:"Export Filename",style:{width:400},value:e.filename||""};return o.a.createElement("div",{className:t.root},o.a.createElement(Y.a,{container:!0},o.a.createElement(Y.a,{item:!0,xs:12},o.a.createElement(h.TextField,n)),o.a.createElement(Y.a,{item:!0,xs:12,className:t.gridItem},o.a.createElement(h.TextField,a)),o.a.createElement(Y.a,{item:!0,xs:12,className:t.gridItem},o.a.createElement(o.a.Fragment,null,"Set Button Style to:",o.a.createElement(h.DropdownSelect,{kind:"line",value:e.style,onChange:function(t){return e.updateButtonStyle(JSON.stringify(t.target.value))},style:{marginLeft:10}},o.a.createElement("option",null,"outline"),o.a.createElement("option",null,"primary"),o.a.createElement("option",null,"destructive"))))))},te=n(216),ne=n.n(te),ae=(n(442),{height:"calc(100vh - 170px)"}),oe={backgroundColor:"rgb(245, 245, 245)",height:26,paddingTop:12,paddingBottom:12,paddingLeft:18};var le=function(e){var t=Object(a.useState)(0),n=Object(F.a)(t,2),l=n[0],s=n[1];function i(e,t,n){if(n>=e.length)for(var a=n-e.length+1;a--;)e.push(void 0);return e.splice(n,0,e.splice(t,1)[0]),e}return Object(a.useEffect)((function(){console.log("[Configure.js] useEffect"),tableau.extensions.initializeDialogAsync().then((function(t){console.log("[Configure.js] Initialise Dialog",t);var n=tableau.extensions.settings.get("selectedSheets");if(n&&null!=n){var a=JSON.parse(n);console.log("[Configure.js] Existing Sheet Settings Found",n),j(a).then((function(t){e.updateMeta(t)}))}var o=tableau.extensions.settings.get("buttonLabel");o&&null!=o&&(o=o.replace(/"/g,""),console.log("[Configure.js] initializeDialogAsync Existing Label Settings Found",o),e.updateLabel(o));var l=tableau.extensions.settings.get("buttonStyle");l&&null!=l&&(console.log("[Configure.js] initializeDialogAsync Existing Label Style Found",l),e.updateButtonStyle(l));var s=tableau.extensions.settings.get("filename");s&&null!=s&&(console.log("[Configure.js] initializeDialogAsync Existing Filename Found",s),e.updateFilename(s))}))}),[]),o.a.createElement("div",null,o.a.createElement("div",{style:oe},o.a.createElement("img",{style:{height:20},src:ne.a,alt:"The Information Lab"})),o.a.createElement(h.Tabs,{onTabChange:function(e){s(e)},selectedTabIndex:l,tabs:[{content:"Select Sheets"},{content:"Select Columns"},{content:"Configure"}]},o.a.createElement("div",{style:ae},0===l?o.a.createElement(z,{sheets:e.meta,selectSheet:function(t){console.log("[Configure.js] selectSheetHandler",t);var n=e.meta;n[t].selected=!n[t].selected,e.updateMeta(n),e.changeSettings(!0)},changeOrder:function(t,n){if(console.log("[Configure.js] changeSheetOrderHandler",t,n),n>0){var a=i(e.meta,t,n-1);e.updateMeta(a),e.changeSettings(!0)}},changeName:function(t,n){console.log("[Configure.js] changeSheetNameHandler",t,n);var a=e.meta;a[t].changeName=n,e.updateMeta(a),e.changeSettings(!0)}}):null,1===l?o.a.createElement($,{sheets:e.meta,colSelect:function(t,n){console.log("[Configure.js] selectColumnHandler",t,n);var a=e.meta,o=a[t];o.columns[n].selected=!o.columns[n].selected,a[t]=o,e.updateMeta(a),e.changeSettings(!0)},changeName:function(t,n,a){console.log("[Configure.js] changeColumnNameHandler",t,n,a);var o=e.meta,l=o[t];l.columns[n].changeName=a,o[t]=l,e.updateMeta(o),e.changeSettings(!0)},changeOrder:function(t,n,a){if(console.log("[Configure.js] changeColumnOrderHandler",t,n,a),a>0){var o=e.meta,l=i(o[t].columns,n,a-1);l.map((function(e,t){return e.order=t,e})),o[t].columns=l,e.updateMeta(o),e.changeSettings(!0)}}}):null,2===l?o.a.createElement(ee,{label:e.label,filename:e.filename,style:e.style,updateLabel:function(t){console.log("[Configure.js] changeUpdateLabelHandler",t),e.updateLabel(t),e.changeSettings(!0)},updateButtonStyle:function(t){console.log("[Configure.js] changeLabelStyleHandler",t),e.updateButtonStyle(t),e.changeSettings(!0)},updateFilename:function(t){console.log("[Configure.js] updateFilenameHandler",t),e.updateFilename(t),e.changeSettings(!0)}}):null)),o.a.createElement(X,{enableButton:e.enableSave,save:function(){console.log("[Configure.js] saveSettingsHandler - Saving Settings",e);var t=e.meta,n=e.label,a=e.style,o=e.filename;e.disableButton(!1),console.log("[Configure.js] saveSettingsHandler - sheets",t),E("sheets",t).then(E("label",n)).then(E("style",a)).then(E("filename",o)).then(x()).then((function(t){console.log("[Configure.js] Saved Settings",t),e.changeSettings(!1);var n=tableau.extensions.settings.get("selectedSheets");if(n&&null!=n){var a=JSON.parse(n);console.log("[Configure.js] Sheet Settings Updated",a)}}))},resetSettings:function(){console.log("[Configure.js] resetSettingsHandler - Reset Settings"),y().then((function(t){e.updateMeta(t)}))}}))},se=n(469);n(443);var ie=function(){return console.log("[DesktopExport.js] Initialise Export Screen"),Object(a.useEffect)((function(){console.log("[DesktopExport.js] useEffect"),tableau.extensions.initializeDialogAsync().then((function(e){console.log("[DesktopExport.js] Initialise Dialog",e);tableau.extensions.settings.get("selectedSheets")}))}),[]),o.a.createElement(Y.a,{container:!0,spacing:0,align:"left",justify:"center"},o.a.createElement(Y.a,{item:!0},o.a.createElement(se.a,{component:"div",style:{padding:20}},o.a.createElement("p",null,"Hi There!"),o.a.createElement("p",null,"It looks like you're trying to create the Excel file using a desktop version earlier than 2019.4. Unfortunately you ","can't"," as the download function is disabled, however there are two solutions. Either publish your dashboard to Server where the Excel file will download as expected, or upgrade your copy of Desktop to 2019.4 or greater."),o.a.createElement("p",null,"To those who've previously emailed Tableau to request they enable the download feature...we did it!! Thank you so much for taking the time to present the case, I ","can't"," believe how many emails you sent. ","I'm"," humbled."),o.a.createElement("p",null,"Craig"))))},re=(n(444),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(r.a)(this,n),console.log("[Main.js] constructor"),(a=t.call(this,e)).metaVersionChangedHandler=function(e){console.log("[Main.js] Updating meta version to ".concat(e)),a.setState({metaVersion:e})},a.labelChangedHandler=function(e){console.log("[Main.js] Updating label text to ".concat(e));var t=Object(i.a)(Object(i.a)({},a.state.button),{},{label:e});a.setState({button:t})},a.filenameChangedHandler=function(e){console.log("[Main.js] Updating filename to ".concat(JSON.parse(e))),a.setState({filename:JSON.parse(e)})},a.buttonStateChangedHandler=function(e){console.log("[Main.js] Changing button state to ".concat(e));var t=Object(i.a)(Object(i.a)({},a.state.button),{},{disabled:e});a.setState({button:t})},a.buttonStyleChangedHandler=function(e){console.log("[Main.js] Changing button style to ".concat(e));var t=Object(i.a)(Object(i.a)({},a.state.button),{},{style:JSON.parse(e)});a.setState({button:t})},a.metaChangedHandler=function(e){console.log("[Main.js] Meta changed",e),a.setState({meta:e})},a.settingsChangedHandler=function(e){console.log("[Main.js] Settings changed",e),a.setState({settingsChanged:e})},a.resetSettingsHandler=function(){console.log("[Main.js] Reset Settings"),a.setState({meta:void 0,metaVersion:2,button:{label:"Export All",style:"outline",disabled:!0},isLoading:!1,filename:"ExportAll",settingsChanged:!1})},a.renderExtension=function(){return o.a.createElement(M,{label:a.state.button.label,meta:a.state.meta,metaVersion:a.state.metaVersion,style:a.state.button.style,filename:a.state.filename,disabled:a.state.button.disabled,updateMetaVersion:a.metaVersionChangedHandler,updateMeta:a.metaChangedHandler,disableButton:a.buttonStateChangedHandler,updateLabel:a.labelChangedHandler,updateButtonStyle:a.buttonStyleChangedHandler,updateFilename:a.filenameChangedHandler})},a.renderConfigure=function(){return o.a.createElement(le,{label:a.state.button.label,meta:a.state.meta,style:a.state.button.style,filename:a.state.filename,enableSave:a.state.settingsChanged,updateMeta:a.metaChangedHandler,disableButton:a.buttonStateChangedHandler,updateLabel:a.labelChangedHandler,changeSettings:a.settingsChangedHandler,updateButtonStyle:a.buttonStyleChangedHandler,updateFilename:a.filenameChangedHandler,resetSettings:a.resetSettingsHandler})},a.renderDesktopExport=function(){return o.a.createElement(ie,null)},a.state={meta:void 0,metaVersion:2,button:{label:"Export All",style:"outline",disabled:!0},isLoading:!1,filename:"ExportAll",settingsChanged:!1},console.log("[Main.js] state initialised",a.state),a}return Object(c.a)(n,[{key:"componentWillMount",value:function(){console.log("[Main.js] componentWillMount")}},{key:"componentDidMount",value:function(){console.log("[Main.js] componentDidMount")}},{key:"render",value:function(){return o.a.createElement(g.a,null,o.a.createElement("div",null,o.a.createElement(m.a,{path:"/configure",render:this.renderConfigure,exact:!0}),o.a.createElement(m.a,{path:"/desktopexport",render:this.renderDesktopExport,exact:!0}),o.a.createElement(m.a,{path:"/",render:this.renderExtension,exact:!0})))}}]),n}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(re,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[229,1,2]]]);
//# sourceMappingURL=main.26801945.chunk.js.map